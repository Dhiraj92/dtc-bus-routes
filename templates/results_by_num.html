{% extends "index.html" %}

{% block title %}{{ block.super }} | Route {{ route }} | {{ startstage }} to {{ endstage }}{% endblock %}

{% block meta_tags %}
  <meta name="description" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }} lists all stages/stops on route/bus {{ route }}. It tells you all the stops the bus goes with maps. It also tells you timings of the bus.">
  <meta name="keywords" content="dtc, bus, delhi bus, bus routes, delhi bus route,  delhi bus service, dtc bus, dtc bus service, dtc routes, delhi buses, delhi bus list, delhi bus timings, delhi bus details, delhi bus rote details, delhi transport corporation, delhi bus banner, bus in delhi, bus for delhi, bus for south delhi, bus for north delhi, bus for east delhi, buses in delhi,  delhi bus details, delhi bus route finder, delhi bus route no, delhi bus details, delhi bus route chart, delhi bus route search, dtc route {{ route }}, delhi bus route {{ route }}, dtc {{ route }}">

  <meta itemprop="name" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }}">
  <meta itemprop="description" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }} lists all stages/stops on route/bus {{ route }}. It tells you all the stops the bus goes with maps. It also tells you timings of the bus.">

  <meta property="og:title" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }}" />
  <meta property="og:description" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }} lists all stages/stops on route/bus {{ route }}. It tells you all the stops the bus goes with maps. It also tells you timings of the bus." />

  <meta name="twitter:title" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }}">
  <meta name="twitter:description" content="DTC Bus Routes | Route {{ route }} | {{ startstage }} to {{ endstage }} lists all stages/stops on route/bus {{ route }}. It tells you all the stops the bus goes with maps. It also tells you timings of the bus.">
{% endblock %}

{% block js %}
{{ block.super }}
<script>
$(function () {
    $('body').tooltip({
        selector: '[rel=tooltip]'
    });

    $(document).on('mouseenter', 'span[rel=tooltip]', function () {
        var ele = $(this)
        stage = $(this).html()
        $.get("{% url 'ajax_buses_from_here' %}?q=" + encodeURIComponent(stage),

        function (response) {
            ele.attr("data-original-title", response);
        });
        $(this).tooltip('show');
    });

    $(document).on('mouseleave', 'span[rel=tooltip]', function () {
        $(this).tooltip('hide');
    });

});
</script>
{% endblock %}

{% block css %}
    {{ block.super }}
    <link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />
    <style>
        #infobox {
            float:left;
        }
        #stops {
            margin-top: 6%;
        }
        #content, #map {
            margin-top: 40px;
            height:100%;
        }
        #map {
            border: 1px dashed grey;
            padding-bottom:45%;
        }
        .leaflet-popup-close-button {
          display: none;
        }
    </style>
{% endblock %}


{% block body %}
    <div class="grid">
     <div class="row">
        <!-- <div class="span2"></div> -->
        <div id="content" class="span4 offset2">
           <div id="infobox">
            <div class="tile bg-color-green" style="width:200px;height:auto;">
                <div class="tile-content">
                    <b> Route : {{ route }} <br/>
                        From : {{ startstage }} <br/>
                        To : {{ endstage }} <br />
                    </b>
                </div>
            </div>
           </div>

           <div id="stops" class="span4">
                <b> Stops At: </b> <br /> <br />
                {% for item in stops %}
                <p> {{item.sequence}}. <span id="res" rel="tooltip" data-placement="right">{{item.stage}}</span> </p>
                {% endfor %}
          </div>
        </div>
        <div id="map" class="span10"></div>

        <script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
        <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>

        <script type="text/javascript">
        var static_url = "{{ STATIC_URL }}";
        </script>
        <script type="text/javascript" src="{{ STATIC_URL }}js/maps.js"></script>

        <script>
                L.mapbox.accessToken = 'pk.eyJ1IjoiZGhpcmFqdCIsImEiOiI1YTMxNzM4NDE2M2MxMDA0NTY0MGNmMWM0NzdiYzJhYyJ9.qR51ols0ubv4BrxG1_pVvw';

                lat = 28.5828
                lng = 77.2511

                var indiagate = new L.LatLng(lat,lng);

                // var mapboxlayer = L.tileLayer(Url,{
			    //             maxZoom: 14,
			    //             attribution: Attribution
			    //       }),
                //
			    //     googlelayer = new L.Google('ROADMAP'),
                //
                //     BingAerialWithLabels = new L.TileLayer.Bing('AqOllaswadzkeAg1p8HrHnhXQnJZ2LSATfibDWbyHYi4UyI9wcFK6j-OFbo2Qkns', "AerialWithLabels",
                //         {
                //             maxZoom: 18,
                //             attribution: ''
                //     });

                var map = L.mapbox.map('map', 'mapbox.streets',{
                            zoomControl: false,
                          })
                          .setView([lat,lng], 13);

                new L.Control.Zoom({ position: 'topleft' }).addTo(map);

                L.control.layers(null,overlayMaps).addTo(map);
           </script>

      </div>
    </div>
{% endblock %}
