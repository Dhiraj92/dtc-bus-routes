{% extends "index.html" %}

{% block js %}

<link href="{{ STATIC_URL }}css/leaflet.css" rel="stylesheet"> 

<script type="text/javascript" src="{{ STATIC_URL }}js/jquery19.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/leaflet.js"></script>



<script>
$(function (){

$('body').tooltip({
    selector: '[rel=tooltip]'
});


$(document).on('mouseenter','span[rel=tooltip]', function(){
    var ele = $(this)
    stage = $(this).html()
    $.get( "{% url ajax_bus %}?q="+ encodeURIComponent(stage), 
            function (response) {
                ele.attr("data-original-title",response);
            }
         );
   $(this).tooltip('show');
});

$(document).on('mouseleave','span[rel=tooltip]', function(){
    $(this).tooltip('hide');
});



});

</script>
{% endblock %}


{% block title %}DTC Bus Routes | Route{% endblock %}



{% block css %}
#infobox {
   float:left;
   width:10%;
 }     
    
#stops { 
   margin-top: 20px;
   float:left;  
}  

#content {
   margin-top: 40px;
}

#map {
    margin-top: 40px;
    border:1px dashed gray;
    height:500px;
    background-color:#ffffff;
    text-align: center;
    
}

.leaflet-control-layers-toggle {
	background-image: url("{{ STATIC_URL }}images/layers.png");
}

.tooltip {
  position: absolute;
  z-index: 1030;
  display: block;
  font-size: 12px;
  line-height: 1.4;
  font-weight:normal;
  opacity: 1;
  filter: alpha(opacity=0);
  visibility: visible;
}

.tooltip.in {
  opacity: 0.8;
  filter: alpha(opacity=80);
}

.tooltip.top {
  padding: 5px 0;
  margin-top: -3px;
}

.tooltip.right {
  padding: 0 5px;
  margin-left: 3px;
}

.tooltip.bottom {
  padding: 5px 0;
  margin-top: 3px;
}

.tooltip.left {
  padding: 0 5px;
  margin-left: -3px;
}

.tooltip-inner {
  max-width: 200px;
  padding: 8px;
  color: #ffffff;
  text-align: center;
  text-decoration: none;
  background-color: #000000;
  -webkit-border-radius: 4px;
     -moz-border-radius: 4px;
          border-radius: 4px;
}

.tooltip-arrow {
  position: absolute;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
}

.tooltip.top .tooltip-arrow {
  bottom: 0;
  left: 50%;
  margin-left: -5px;
  border-top-color: #000000;
  border-width: 5px 5px 0;
}

.tooltip.right .tooltip-arrow {
  top: 50%;
  left: 0;
  margin-top: -5px;
  border-right-color: #000000;
  border-width: 5px 5px 5px 0;
}

.tooltip.left .tooltip-arrow {
  top: 50%;
  right: 0;
  margin-top: -5px;
  border-left-color: #000000;
  border-width: 5px 0 5px 5px;
}

.tooltip.bottom .tooltip-arrow {
  top: 0;
  left: 50%;
  margin-left: -5px;
  border-bottom-color: #000000;
  border-width: 0 5px 5px;
}



{% endblock %}


{% block body %}
    <div class="grid">
     <div class="row">        
        <div class="span2"></div>
        
        <div id="content" class="span4">
           <div id="infobox">
            <div class="tile bg-color-green" style="width:200px;height:auto;">
            <div class="tile-content">
            
            <b> Route : {{ route }} <br/>
                From : {{ first }} <br/>
                To : {{ last }} <br />
            </b>
            </div>
            </div>
           </div>
           <div id="stops" class="span4">
                <b> Stops At: </b> <br /> <br />
                {% for item in stops %}
                <p> {{item.sequence}}. <span id="res" rel="tooltip" data-placement="right">{{item.stage}} </span> </p>
                {% endfor %}  
          </div>
        </div> 
         
          
          <div id="map" class="span10"> </div>
          <script> 
                var Url = 'http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/{styleId}/256/{z}/{x}/{y}.png',
                    Attribution = 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://cloudmade.com">CloudMade</a>';
                
                
                var baselayer=L.tileLayer(Url, 
                {   styleId : 997,
			        maxZoom: 18,
			        attribution: Attribution
			    }),
			    
			        highways=L.tileLayer(Url, 
			    {   styleId: 46561,
			        attribution: Attribution
			        
			    });
               
                
		        var baseIcon = L.Icon.extend({
                     options: {
                        iconSize:     [30, 35], 
                        iconAnchor:   [15, 34], 
                        popupAnchor:  [1, -25]
                     } 
                });

                var busIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/bus.png'}),
                    gmIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/gm.png'}),
                    bmIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/bm.png'}),
                    vmIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/vm.png'}),
                    omIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/om.png'}),
                    rmIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/rm.png'}),
                    ymIcon = new baseIcon({iconUrl: '{{ STATIC_URL }}images/ym.png'});

           </script>
          <script type="text/javascript" src="{{ STATIC_URL }}js/maps.js"></script>

         
      
      </div> 
    </div>      
{% endblock %}
